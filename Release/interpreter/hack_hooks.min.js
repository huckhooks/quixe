if(!window.console){window.console={log:function(a){}}}HackHooks=function(){return{main_winid:-1,windowdic:null,image:null,log:[],next_log:[],hash:null,replaying:null,basetitle:null,send_response:null,started:function(b){console.log("started "+this.main_winid);this.basetitle=document.title;this.image=b;this.hash=location.hash;var a=this;window.onhashchange=function(){a.hash_change()};console.log("replay");this.do_skein()},notify_new_win:function(a){if(this.main_winid==-1){this.main_winid=a}},gotLine:function(a){console.log(JSON.stringify(a));this.log.push(a.value);if(!this.replaying){this.set_url_hash();this.update_title()}console.log("done")},load:function(){console.log("load");this.do_skein();return false},do_skein:function(){var b=location.hash.substring(1);console.log(b);if(b[0]==="%"){b=unescape(b)}this.next_log=[];try{b=JSON.parse(b);this.next_log=b.log}catch(d){}this.log=[];console.log(this.next_log);var c=this.windowdic.get(this.main_winid);this.replaying=true;for(var a=0;a<this.next_log.length;a++){this.send_response("line",c,this.next_log[a],null)}this.replaying=false;this.update_title()},hash_change:function(){var a=this.hash!==location.hash;console.log("hashchange "+a);if(a){console.log("old: "+this.hash);console.log("new: "+location.hash);if(true||confirm("url-skein has changed, reload?")){window.location.reload()}}return true},set_url_hash:function(){var a=JSON.stringify({log:this.log});console.log(a);var b="# "+a;location.hash=b;this.hash=location.hash},update_title:function(){var a=this.log.length>0?this.log[this.log.length-1]:"New Game";document.title=a+" - "+this.log.length+" - "+this.basetitle},insert_text:function(d,f){var b;if(b=/^(.*?.). Url: (.*)$/.exec(f)){if(!/.*:.*/.exec(b[2])){b[2]="../Browsies/"+b[2]}var a=new Element("a",{href:b[2],target:"_blank",title:"opens in new window/tab"}).update(b[1]+".");d.appendChild(a);return true}else{if(b=/^(.*?.). IFrame: (\w*), (.*)/.exec(f)){if(!/.*:.*/.exec(b[3])){b[3]="../Browsies/"+b[3]}var a=new Element("a",{href:b[3],target:"_blank",title:"opens in new window/tab"}).update(b[1]+".");d.appendChild(a);var e=new Element("br",{});d.appendChild(e);var c=new Element("iframe",{src:b[3],style:"width: 100%; height: "+b[2]});d.appendChild(c);return true}else{if(b=/^(.*?.). Popup: (.*)/.exec(f)){if(!/.*:.*/.exec(b[2])){b[2]="../Browsies/"+b[2]}var a=new Element("a",{href:b[2],target:"_blank",title:"opens in new window/tab"}).update(b[1]+".");d.appendChild(a);var e=new Element("br",{});d.appendChild(e);if((!this.replaying)&&confirm("Open in new window/tab?")){window.open(b[2])}return true}else{if(b=/^(.*?.). Browse: (.*)/.exec(f)){if(!/.*:.*/.exec(b[2])){b[2]="../Browsies/"+b[2]}var a=new Element("a",{href:b[2],target:"_blank",title:"opens in new window/tab"}).update(b[1]+".");d.appendChild(a);var e=new Element("br",{});d.appendChild(e);if((!this.replaying)&&confirm("Use back-button to go back to game.")){location.href=b[2]}return true}else{if(b=/^(.*?.). Image: (.*)/.exec(f)){if(!/.*:.*/.exec(b[2])){b[2]="../Browsies/"+b[2]}var a=new Element("a",{href:b[2],target:"_blank",title:"opens in new window/tab"}).update(b[1]+".");d.appendChild(a);var e=new Element("br",{});d.appendChild(e);var c=new Element("img",{src:b[2]});d.appendChild(c);return true}}}}}return false}}}();